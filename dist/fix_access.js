// Â© 2025 City Pave. All Rights Reserved. Unauthorized copying is prohibited.
import { initializeApp } from "https: import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https: import { getFirestore, doc, setDoc } from "https: const firebaseConfig = { apiKey: "AIzaSyADrnYgh1fSTo3IZD7HOEJMyjduzDYIYSs", authDomain: "city-pave-estimator.firebaseapp.com", projectId: "city-pave-estimator", storageBucket: "city-pave-estimator.firebasestorage.app", messagingSenderId: "111714884839", appId: "1:111714884839:web:2b782a1b7be5be8edc5642" }; const app = initializeApp(firebaseConfig); const auth = getAuth(app); const db = getFirestore(app); async function restoreAccess() { const email = "dev@citypave.ca"; const password = "Admin123!"; console.log(`Attempting to restore access for ${email}...`); try { const userCredential = await createUserWithEmailAndPassword(auth, email, password); const user = userCredential.user; console.log("User created successfully:", user.uid); await setAdminRole(user); } catch (error) { if (error.code === 'auth/email-already-in-use') { console.log("User already exists. Attempting sign in..."); try { const userCredential = await signInWithEmailAndPassword(auth, email, password); console.log("Signed in successfully."); await setAdminRole(userCredential.user); } catch (loginError) { console.error("Could not sign in with provided password.", loginError.message); console.log("Creating backup admin: dev2@citypave.ca"); try { const backupCred = await createUserWithEmailAndPassword(auth, "dev2@citypave.ca", "Admin123!"); await setAdminRole(backupCred.user); alert("Original login failed (wrong password?). Created 'dev2@citypave.ca' with password 'Admin123!' instead."); } catch (backupError) { if (backupError.code === 'auth/email-already-in-use') { const backupCred = await signInWithEmailAndPassword(auth, "dev2@citypave.ca", "Admin123!"); await setAdminRole(backupCred.user); alert("Logged in as dev2@citypave.ca. You are good to go."); } else { alert("Critical Failure: " + backupError.message); } } } } else { console.error("Error:", error); alert("Error: " + error.message); } } } async function setAdminRole(user) { await setDoc(doc(db, "users", user.uid), { uid: user.uid, email: user.email, role: 'super_admin', name: 'Developer Admin', createdAt: new Date().toISOString() }); console.log("Admin privileges granted to", user.email); alert(`Success! User ${user.email} is now a Super Admin. You can log in.`); } restoreAccess();