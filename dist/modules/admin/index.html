<!-- // ¬© 2025 City Pave. All Rights Reserved. Unauthorized copying is prohibited. -->
<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Admin Command Center | City Pave</title><script src="https://cdn.tailwindcss.com"></script><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet"><style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }

        .glass-panel {
            background: white;
            border: 1px solid #e5e7eb;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .nav-btn.active {
            background-color: #eff6ff;
            color: #2563eb;
            border-right: 3px solid #2563eb;
        }
    </style></head><body class="h-screen flex flex-col overflow-hidden"><div id="app-navigation" class="fixed top-0 left-0 right-0 z-50"></div><script type="module" src="../../navigation.js"></script><div class="h-16 flex-shrink-0"></div><div class="flex flex-1 overflow-hidden"><aside class="w-64 bg-white border-r border-gray-200 flex flex-col z-10"><div class="p-6 border-b border-gray-100"><h1 class="text-xl font-bold text-gray-800 flex items-center gap-2"><span class="text-2xl">üèóÔ∏è</span> Admin Hub
                </h1><p class="text-xs text-gray-500 mt-1">Business Owner Console</p></div><nav class="flex-grow p-4 space-y-1"><button onclick="switchSection('hr')" id="nav-hr"
                    class="nav-btn active w-full text-left px-4 py-3 rounded-r-lg text-sm font-bold text-gray-600 hover:bg-gray-50 transition flex items-center gap-3"><span>üë•</span> Human Resources
                </button><button onclick="switchSection('fleet')" id="nav-fleet"
                    class="nav-btn w-full text-left px-4 py-3 rounded-r-lg text-sm font-bold text-gray-600 hover:bg-gray-50 transition flex items-center gap-3"><span>üöõ</span> Fleet & Assets
                </button><button onclick="switchSection('finance')" id="nav-finance"
                    class="nav-btn w-full text-left px-4 py-3 rounded-r-lg text-sm font-bold text-gray-600 hover:bg-gray-50 transition flex items-center gap-3"><span>üí≥</span> Financial & Legal
                </button><button onclick="switchSection('permissions')" id="nav-permissions"
                    class="nav-btn w-full text-left px-4 py-3 rounded-r-lg text-sm font-bold text-gray-600 hover:bg-gray-50 transition flex items-center gap-3"><span>üõ°Ô∏è</span> Permissions Board
                </button></nav><div class="p-4 border-t border-gray-200"><div class="flex justify-between items-end mb-1"><span class="text-xs font-bold text-gray-500 uppercase">Storage</span><span id="storage-text" class="text-xs text-gray-700 font-mono">0%</span></div><div class="w-full bg-gray-200 rounded-full h-2.5 mb-2"><div id="storage-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div></div><button class="text-xs text-blue-600 hover:underline w-full text-center">Manage Storage</button></div></aside><main class="flex-grow overflow-y-auto p-8"><div id="sec-hr" class="space-y-6"><div class="flex justify-between items-center"><div><h2 class="text-2xl font-bold text-gray-800">Staff Management</h2><p class="text-gray-500 text-sm">Manage users, roles, and certifications.</p></div><button onclick="openModal('add-user-modal')"
                        class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-bold shadow-sm transition">
                        + Add New Employee
                    </button></div><div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"><table class="w-full text-left text-sm"><thead class="bg-gray-50 text-gray-500 border-b border-gray-200"><tr><th class="p-4 font-bold">Employee</th><th class="p-4 font-bold">Role</th><th class="p-4 font-bold">Certifications</th><th class="p-4 font-bold">Status</th><th class="p-4 text-right">Actions</th></tr></thead><tbody id="staff-list-body" class="divide-y divide-gray-100"></tbody></table></div><div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6"><h3 class="text-lg font-bold text-gray-800 mb-4">Role Permissions & Mini-Apps</h3><div class="grid grid-cols-1 md:grid-cols-3 gap-4"><div class="border rounded p-4"><h4 class="font-bold text-gray-700 mb-2">Laborer</h4><ul class="text-sm text-gray-500 space-y-1"><li class="flex items-center gap-2"><span class="text-green-500">‚úî</span> Time Clock
                                </li><li class="flex items-center gap-2"><span class="text-red-500">‚úò</span> Invoicing</li><li class="flex items-center gap-2"><span class="text-red-500">‚úò</span> Fleet Admin</li></ul></div><div class="border rounded p-4"><h4 class="font-bold text-gray-700 mb-2">Foreman</h4><ul class="text-sm text-gray-500 space-y-1"><li class="flex items-center gap-2"><span class="text-green-500">‚úî</span> Time Clock
                                </li><li class="flex items-center gap-2"><span class="text-green-500">‚úî</span> Daily Logs
                                </li><li class="flex items-center gap-2"><span class="text-red-500">‚úò</span> Financials</li></ul></div><div class="border rounded p-4 bg-gray-50"><button id="configure-rbac-btn" onclick="switchSection('permissions')"
                                class="w-full h-full flex items-center justify-center text-blue-600 font-bold hover:underline">
                                Configure RBAC Matrix ‚Üí
                            </button></div></div></div></div><div id="sec-fleet" class="hidden space-y-6"><div class="flex justify-between items-center"><div><h2 class="text-2xl font-bold text-gray-800">Fleet & Asset Registry</h2><p class="text-gray-500 text-sm">Manage trucks, equipment, and material costs.</p></div><div class="flex gap-2"><button
                            class="bg-white border border-gray-300 text-gray-700 px-4 py-2 rounded-lg font-bold hover:bg-gray-50">Manage
                            Materials</button><button
                            class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-bold shadow-sm transition">+
                            Add Vehicle</button></div></div><div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6"><h3 class="font-bold text-gray-800 mb-4">Active Vehicles</h3><ul class="space-y-3" id="vehicle-list"><li class="text-gray-400 text-sm italic">Loading fleet...</li></ul></div><div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6"><h3 class="font-bold text-gray-800 mb-4">Material Unit Costs</h3><ul class="space-y-3"><li
                                class="flex justify-between items-center p-2 hover:bg-gray-50 rounded border border-transparent hover:border-gray-200"><span class="text-sm font-medium">Asphalt (Top)</span><span class="text-sm font-mono bg-gray-100 px-2 py-1 rounded">$85.00/ton</span></li><li
                                class="flex justify-between items-center p-2 hover:bg-gray-50 rounded border border-transparent hover:border-gray-200"><span class="text-sm font-medium">Concrete (4000psi)</span><span class="text-sm font-mono bg-gray-100 px-2 py-1 rounded">$145.00/yd</span></li></ul></div></div></div><div id="sec-finance" class="hidden space-y-6"><h2 class="text-2xl font-bold text-gray-800">Financial & Legal Configuration</h2><div class="grid grid-cols-1 lg:grid-cols-2 gap-6"><div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6"><h3 class="font-bold text-gray-800 mb-4">Payment Integrations</h3><p class="text-sm text-gray-500 mb-4">These keys allow you to receive payments directly on
                            invoices.
                        </p><div class="space-y-4"><div><label class="block text-xs font-bold text-gray-700 uppercase mb-1">Stripe Public
                                    Key</label><input type="text" class="w-full border border-gray-300 rounded p-2 text-sm font-mono"
                                    placeholder="pk_live_..."></div><div><label class="block text-xs font-bold text-gray-700 uppercase mb-1">Venmo Handle</label><input type="text" class="w-full border border-gray-300 rounded p-2 text-sm"
                                    placeholder="@YourCompany"></div><button class="bg-green-600 text-white px-4 py-2 rounded font-bold text-sm w-full">Save
                                Keys</button></div></div><div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6"><h3 class="font-bold text-gray-800 mb-4">Custom Liability Waiver</h3><p class="text-sm text-gray-500 mb-4">Upload your specific Terms & Conditions that customers
                            must
                            sign.</p><div
                            class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:bg-gray-50 transition cursor-pointer"><span class="text-4xl block mb-2">üìÑ</span><span class="text-sm text-gray-600 font-bold">Click to Upload PDF</span><span class="text-xs text-gray-400 block mt-1">Max 5MB</span></div></div><div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6"><h3 class="font-bold text-gray-800 mb-4">Estimator Permissions</h3><p class="text-sm text-gray-500 mb-4">Control what estimators can update globally.</p><div class="space-y-3"><label class="flex items-center p-2 hover:bg-gray-50 rounded cursor-pointer"><input type="checkbox" id="perm-terms-default"
                                    class="h-4 w-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"><span class="ml-2 text-sm text-gray-700">Allow updating <strong>Default</strong> Terms &
                                    Conditions</span></label><label class="flex items-center p-2 hover:bg-gray-50 rounded cursor-pointer"><input type="checkbox" id="perm-terms-all"
                                    class="h-4 w-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"><span class="ml-2 text-sm text-gray-700">Allow updating <strong>ALL</strong> Estimates'
                                    Terms & Conditions</span></label><div class="border-t my-2"></div><label class="flex items-center p-2 hover:bg-gray-50 rounded cursor-pointer"><input type="checkbox" id="perm-appendix-default"
                                    class="h-4 w-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"><span class="ml-2 text-sm text-gray-700">Allow updating <strong>Default</strong>
                                    Appendix</span></label><label class="flex items-center p-2 hover:bg-gray-50 rounded cursor-pointer"><input type="checkbox" id="perm-appendix-all"
                                    class="h-4 w-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"><span class="ml-2 text-sm text-gray-700">Allow updating <strong>ALL</strong> Estimates'
                                    Appendix</span></label></div><button id="save-permissions-btn"
                            class="mt-4 bg-blue-600 text-white px-4 py-2 rounded font-bold text-sm w-full hover:bg-blue-700 transition">Save
                            Permissions</button></div></div><div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200"><h3 class="text-lg font-bold text-gray-800 mb-4">‚òÅÔ∏è Hybrid Storage</h3><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div
                            class="border p-4 rounded-lg cursor-pointer hover:bg-blue-50 border-blue-500 bg-blue-50 relative"><div class="absolute top-2 right-2 text-blue-600"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd"
                                        d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                                        clip-rule="evenodd"></path></svg></div><h4 class="font-bold text-blue-900">Managed Storage</h4><p class="text-xs text-blue-700 mt-1">Hosted by City Pave (Firebase). Secure, backed up, and
                                zero-config.</p></div><div class="border p-4 rounded-lg cursor-pointer hover:bg-gray-50 border-gray-200 opacity-60"><h4 class="font-bold text-gray-800">Bring Your Own (BYOS)</h4><p class="text-xs text-gray-500 mt-1">Connect AWS S3 or Google Drive. You manage keys and
                                costs.
                            </p><button class="mt-2 text-xs bg-gray-200 text-gray-600 px-2 py-1 rounded"
                                onclick="alert('BYOS requires Titan Plan')">Configure</button></div></div></div></div><div id="sec-permissions" class="hidden space-y-6"><div class="glass-panel rounded-xl p-6"><div class="flex justify-between items-center mb-6"><div><h2 class="text-xl font-bold text-gray-800 flex items-center gap-2"><span class="text-yellow-400">üõ°Ô∏è</span> Permissions Control Board
                            </h2><p class="text-gray-500 text-sm mt-1">Manage Role-Based Access Control (RBAC) across the
                                platform.</p></div><div id="rbac-status-indicator"
                            class="px-3 py-1 rounded-full text-xs font-bold bg-gray-100 text-gray-600 border border-gray-200">
                            Read-Only Mode
                        </div></div><div class="overflow-x-auto"><table class="w-full text-left text-sm"><thead><tr class="text-gray-500 border-b border-gray-200"><th class="pb-3 pl-2">Feature / Module</th><th class="pb-3 text-center w-24">Admin</th><th class="pb-3 text-center w-24">Manager</th><th class="pb-3 text-center w-24">Staff</th><th class="pb-3 text-center w-24">Viewer</th></tr></thead><tbody id="rbac-matrix-body"><tr><td colspan="5" class="text-center py-8 text-gray-500">Loading permissions matrix...
                                    </td></tr></tbody></table></div><div id="rbac-actions" class="mt-6 pt-6 border-t border-gray-200 flex justify-end gap-3 hidden"><button onclick="renderRBACMatrix()"
                            class="px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg text-sm font-bold transition">Reset</button><button onclick="saveRBACChanges()"
                            class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-bold shadow-lg shadow-blue-900/50 transition">Save
                            Permissions</button></div></div></div><div id="sec-settings" class="hidden space-y-6"><div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6"><h2 class="text-xl font-bold mb-4">System Settings</h2><p class="text-gray-500">Global system configuration...</p></div></div></main></div><div id="add-user-modal" class="hidden fixed inset-0 bg-black/50 z-50 flex items-center justify-center"><div class="bg-white w-full max-w-md p-6 rounded-xl shadow-2xl"><h3 class="text-xl font-bold mb-4">Add New Employee</h3><form id="add-user-form" class="space-y-4"><div><label class="block text-xs font-bold text-gray-700 uppercase mb-1">Full Name</label><input type="text" id="new-user-name" class="w-full border border-gray-300 rounded p-2" required></div><div><label class="block text-xs font-bold text-gray-700 uppercase mb-1">Email</label><input type="email" id="new-user-email" class="w-full border border-gray-300 rounded p-2" required></div><div><label class="block text-xs font-bold text-gray-700 uppercase mb-1">Password</label><input type="password" id="new-user-password" class="w-full border border-gray-300 rounded p-2"
                        required placeholder="Min 6 chars"></div><div><label class="block text-xs font-bold text-gray-700 uppercase mb-1">Role</label><select id="new-user-role" class="w-full border border-gray-300 rounded p-2"><option value="laborer">Laborer</option><option value="foreman">Foreman</option><option value="admin">Admin</option></select></div><div class="p-3 bg-gray-50 rounded border border-gray-200"><label class="block text-xs font-bold text-gray-700 uppercase mb-2">Certifications</label><div class="space-y-2"><label class="flex items-center text-sm"><input type="checkbox" class="mr-2"> OSHA 10</label><label class="flex items-center text-sm"><input type="checkbox" class="mr-2"> CDL
                            License</label><button type="button" class="text-xs text-blue-600 font-bold hover:underline">+ Upload
                            Document</button></div></div><div class="flex justify-end gap-3 mt-6"><button type="button" onclick="closeModal('add-user-modal')"
                        class="px-4 py-2 text-gray-500 hover:text-gray-700">Cancel</button><button type="submit"
                        class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded">Create
                        User</button></div></form></div></div><th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
        Estimator</th><th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
        Foreman</th><th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
        Crew</th><th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
        Mechanic</th><th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
        Sales</th></tr></thead><tbody class="bg-white divide-y divide-gray-200" id="rbac-matrix-body"></tbody></table></div><div class="mt-6 flex justify-end"><button onclick="closeModal('rbac-matrix-modal')"
            class="px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 font-medium">Close</button></div></div></div><script type="module" src="admin-dashboard.js"></script><script type="module" src="../../qa-agent.js"></script><script>
        // Simple Tab Switcher
        window.switchSection = (id) => {
            document.querySelectorAll('main > div').forEach(el => el.classList.add('hidden'));
            document.getElementById(`sec-${id}`).classList.remove('hidden');

            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`nav-${id}`).classList.add('active');
        };

        window.openModal = (id) => document.getElementById(id).classList.remove('hidden');
        window.closeModal = (id) => document.getElementById(id).classList.add('hidden');
    </script></body></html>