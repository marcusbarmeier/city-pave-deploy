<!-- // Â© 2025 City Pave. All Rights Reserved. Unauthorized copying is prohibited. -->
<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Project Dashboard - City Pave</title><script src="https://cdn.tailwindcss.com"></script><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"><style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #F3F4F6;
        }

        /* SECURITY: Prevent Printing and Copying */
        @media print {
            body {
                display: none !important;
            }
        }

        .secure-content {
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        .timeline-connector {
            position: absolute;
            top: 24px;
            left: 16px;
            bottom: -24px;
            width: 2px;
            background-color: #e2e8f0;
            z-index: 0;
        }

        .timeline-item:last-child .timeline-connector {
            display: none;
        }

        .status-active {
            border-color: #2563eb;
            background-color: #eff6ff;
            color: #1e40af;
        }

        .status-complete {
            border-color: #10b981;
            background-color: #ecfdf5;
            color: #065f46;
        }

        .status-pending {
            border-color: #cbd5e1;
            background-color: white;
            color: #64748b;
        }
    </style></head><body class="text-slate-800"><div id="portal-loading" class="fixed inset-0 bg-white z-50 flex flex-col items-center justify-center"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mb-4"></div><p class="text-gray-500 text-sm">Loading your project dashboard...</p></div><div id="portal-content" class="hidden min-h-screen flex flex-col"><header class="bg-white shadow-sm border-b border-slate-200 sticky top-0 z-40"><div class="max-w-5xl mx-auto px-4 py-4 flex justify-between items-center"><div class="flex items-center gap-3"><img id="company-logo" src="" alt="City Pave" class="h-8 w-auto"><div class="h-6 w-px bg-slate-300 mx-2 hidden md:block"></div><h1 class="text-lg font-bold hidden md:block text-slate-700">Client Portal</h1></div><div class="text-right"><p id="project-title" class="font-bold text-sm md:text-base">Project Name</p><p id="project-id" class="text-xs text-slate-500">ID: #000000</p></div></div></header><main class="flex-grow max-w-5xl mx-auto w-full p-4 md:p-8 space-y-8"><section id="section-timeline" class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6"><h2 class="text-xl font-bold mb-6 text-slate-800">Project Timeline</h2><div class="space-y-0" id="timeline-container"></div></section><section id="section-live-map"
                class="hidden bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden"><div class="p-4 border-b border-slate-100 flex justify-between items-center"><h2 class="text-xl font-bold text-slate-800">Live Haul Map</h2><span
                        class="flex items-center gap-2 text-xs font-bold text-green-600 bg-green-50 px-2 py-1 rounded-full"><span class="relative flex h-2 w-2"><span
                                class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span><span class="relative inline-flex rounded-full h-2 w-2 bg-green-500"></span></span>
                        Active Tracking
                    </span></div><div id="haul-map" class="w-full h-80 bg-slate-100"></div></section><section id="section-tickets" class="hidden bg-white rounded-2xl shadow-sm border border-slate-200 p-6"><div class="flex justify-between items-center mb-6"><h2 class="text-xl font-bold text-slate-800">Load Tickets</h2><div class="text-right"><p class="text-xs text-slate-500 uppercase font-bold">Total Quantity</p><p id="total-load-qty" class="text-lg font-bold text-blue-600">0.00 Tonnes</p></div></div><div class="overflow-x-auto"><table class="w-full text-left text-sm"><thead class="bg-slate-50 text-xs font-bold text-slate-500 uppercase"><tr><th class="px-4 py-3 rounded-l-lg">Date/Time</th><th class="px-4 py-3">Ticket #</th><th class="px-4 py-3">Truck</th><th class="px-4 py-3 text-right">Qty</th><th class="px-4 py-3 rounded-r-lg text-right">Image</th></tr></thead><tbody id="ticket-list-body" class="divide-y divide-slate-100"><tr><td colspan="5" class="p-4 text-center text-slate-400">No tickets uploaded yet.</td></tr></tbody></table></div></section><section class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6"><div class="flex justify-between items-center mb-6"><h2 class="text-xl font-bold text-slate-800">Live Gallery</h2><span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full font-semibold">Updated
                        Real-time</span></div><div id="gallery-grid" class="grid grid-cols-2 md:grid-cols-4 gap-4"><p class="text-gray-400 col-span-full text-center py-8">No photos uploaded yet.</p></div></section><section class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6"><h2 class="text-xl font-bold mb-6 text-slate-800">Financial Overview</h2><div class="grid grid-cols-1 md:grid-cols-3 gap-6"><div class="p-4 bg-slate-50 rounded-xl border border-slate-100"><p class="text-xs font-bold text-slate-500 uppercase mb-1">Total Contract</p><p id="finance-total" class="text-2xl font-bold text-slate-800">$0.00</p></div><div class="p-4 bg-green-50 rounded-xl border border-green-100"><p class="text-xs font-bold text-green-700 uppercase mb-1">Paid to Date</p><p id="finance-paid" class="text-2xl font-bold text-green-700">$0.00</p></div><div class="p-4 bg-blue-50 rounded-xl border border-blue-100"><p class="text-xs font-bold text-blue-700 uppercase mb-1">Remaining Balance</p><p id="finance-balance" class="text-2xl font-bold text-blue-700">$0.00</p></div></div><div class="mt-6 text-right"><button id="view-invoice-btn"
                        class="text-sm font-bold text-blue-600 hover:text-blue-800 hover:underline">View Detailed
                        Invoice &rarr;</button></div></section></main><footer class="bg-white border-t border-slate-200 py-8 mt-8"><div class="max-w-5xl mx-auto px-4 text-center"><p class="text-sm text-slate-500">Questions? Contact us at <a href="mailto:Info@citypave.ca"
                        class="text-blue-600 hover:underline">Info@citypave.ca</a></p><p class="text-xs text-slate-400 mt-2">&copy; 2025 City Pave. All Rights Reserved.</p></div></footer></div><script>function initMap() { window.googleMapsLoaded = true; }</script><script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyADrnYgh1fSTo3IZD7HOEJMyjduzDYIYSs&libraries=places&callback=initMap"></script><script type="module" src="./client-portal.js"></script><script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
        import { getFirestore, collection, query, where, getDocs, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-auth.js";
        import { initializeAISuperintendent } from './ai-superintendent.js';

        const firebaseConfig = {
            apiKey: "AIzaSyADrnYgh1fSTo3IZD7HOEJMyjduzDYIYSs",
            authDomain: "city-pave-estimator.firebaseapp.com",
            projectId: "city-pave-estimator",
            storageBucket: "city-pave-estimator.firebasestorage.app",
            messagingSenderId: "111714884839",
            appId: "1:111714884839:web:2b782a1b7be5be8edc5642"
        };

        const app = initializeApp(firebaseConfig);
        window.db = getFirestore(app);
        const auth = getAuth(app);
        window.firebaseServices = { db: window.db, auth, collection, query, where, getDocs, doc, getDoc, GoogleAuthProvider, signInWithPopup };

        // --- AI SUPERINTENDENT INIT (Client Mode) ---
        initializeAISuperintendent('client');
    </script><script type="module" src="../../qa-agent.js"></script><div id="identity-modal"
        class="fixed inset-0 bg-gray-900 bg-opacity-90 z-50 hidden flex items-center justify-center backdrop-blur-sm"><div class="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center mx-4"><div class="mb-6"><div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4"><svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg></div><h2 class="text-2xl font-bold text-gray-900 mb-2">Identity Verification Required</h2><p class="text-gray-600 text-sm">To access this secure project dashboard, please verify your identity
                    using your Google account.</p></div><button id="google-signin-btn"
                class="w-full flex items-center justify-center gap-3 bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 font-medium py-3 px-4 rounded-lg transition-all duration-200 shadow-sm hover:shadow-md"><img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" class="w-5 h-5"
                    alt="Google"><span>Sign in with Google</span></button><p class="mt-6 text-xs text-gray-400">
                This verification is required by the project administrator to ensure secure access to sensitive project
                details.
            </p></div></div></body></html>