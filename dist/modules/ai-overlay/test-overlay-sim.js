// Â© 2025 City Pave. All Rights Reserved. Unauthorized copying is prohibited.
import aiOverlay from './ai-overlay.js'; import { VoiceManager } from './voice-manager.js'; export const OverlaySim = { run: async () => { console.clear(); console.log("%c ðŸ¤– STARTING AI OVERLAY SIMULATION ", "background: #222; color: #bada55; font-size: 16px;"); if (!window.firebaseServices) { console.warn("âš ï¸ Firebase mocks injecting for simulation..."); window.firebaseServices = { db: {}, collection: () => ({}), addDoc: async (col, data) => { console.log(`%c [DATABASE WRITE] ${col.type || 'collection'} `, "color: orange", data); return { id: 'mock-doc-123' }; } }; } console.log("%c [STEP 1] Simulating Geofence Enter... ", "color: cyan"); const mockSite = { id: 'G-100', name: 'Downtown Construction Site' }; window.dispatchEvent(new CustomEvent('geofence-enter', { detail: mockSite })); await new Promise(r => setTimeout(r, 1500)); const aiMsg = document.querySelector('.ai-msg.ai'); if (aiMsg && aiMsg.innerText.includes('Clock in')) { console.log("%c [PASS] AI Prompted correctly: ", "color: green", aiMsg.innerText); } else { console.error("[FAIL] AI did not prompt for Clock In.", aiMsg ? aiMsg.innerText : "No message"); return; } console.log("%c [STEP 2] Simulating User Voice: 'Yes' ", "color: cyan"); await aiOverlay.handleUserMessage("Yes, clock me in."); console.log("%c [STEP 3] Verification ", "color: cyan"); await new Promise(r => setTimeout(r, 1000)); const lastMsgs = Array.from(document.querySelectorAll('.ai-msg')); const successMsg = lastMsgs.find(d => d.innerText.includes('Time Record Created')); if (successMsg) { console.log("%c [SUCCESS] Simulation Complete. Database writes confirmed. ", "background: green; color: white; padding: 4px;"); } else { console.log("%c [FAIL] Did not see confirmation message. ", "background: red; color: white"); } } }; window.OverlaySim = OverlaySim; window.runOverlaySim = OverlaySim.run;