// Â© 2025 City Pave. All Rights Reserved. Unauthorized copying is prohibited.
export class NotificationEngine { constructor() { this.userState = 'idle'; this.permissions = {}; this.logs = []; } setUserState(state) { this.userState = state; console.log(`[NotificationEngine] User state updated to: ${state}`); window.dispatchEvent(new CustomEvent('comm-state-change', { detail: { state } })); } isNotificationAllowed(priority) { if (priority === 'critical') return true; if (this.userState === 'driving' || this.userState === 'operating') { console.warn('[NotificationEngine] Blocked notification due to safety state:', this.userState); return false; } return true; } logEvent(type, data) { const entry = { id: Date.now() + Math.random().toString(36).substr(2, 9), timestamp: new Date().toISOString(), type, data, userState: this.userState }; this.logs.push(entry); console.log('[NotificationEngine] Log entry:', entry); } hasPermission(permissionKey) { return true; } } export const notificationEngine = new NotificationEngine();