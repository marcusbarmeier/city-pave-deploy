// Â© 2025 City Pave. All Rights Reserved. Unauthorized copying is prohibited.
import { BaseBridge } from './BaseBridge.js'; export class EmployeeBridge extends BaseBridge { constructor() { super('employee', 'admin_dashboard'); } async extract(context) { console.log(`[EmployeeBridge] Extracting time logs for ${context.userId || 'ALL'}...`); return [ { id: 'log1', userId: 'u1', date: '2025-05-12', hours: 8.5, job: 'Paving Job A' }, { id: 'log2', userId: 'u1', date: '2025-05-13', hours: 9.0, job: 'Paving Job B' }, { id: 'log3', userId: 'u2', date: '2025-05-12', hours: 8.0, job: 'Paving Job A' } ]; } transform(rawData) { console.log(`[EmployeeBridge] Transforming ${rawData.length} records...`); const report = { generatedAt: new Date().toISOString(), totalHours: 0, overtimeHours: 0, userStats: {} }; rawData.forEach(log => { if (!report.userStats[log.userId]) { report.userStats[log.userId] = { total: 0, ot: 0, logs: [] }; } report.totalHours += log.hours; report.userStats[log.userId].total += log.hours; if (log.hours > 8) { const ot = log.hours - 8; report.overtimeHours += ot; report.userStats[log.userId].ot += ot; } report.userStats[log.userId].logs.push(log.id); }); return report; } async load(processedData, destinationRef) { console.log("[EmployeeBridge] Loading data to Payroll System...", processedData); return { success: true, reportId: `rpt_${Date.now()}` }; } }