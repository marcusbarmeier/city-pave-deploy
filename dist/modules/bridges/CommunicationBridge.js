// Â© 2025 City Pave. All Rights Reserved. Unauthorized copying is prohibited.
import { BaseBridge } from './BaseBridge.js'; export default class CommunicationBridge extends BaseBridge { constructor() { super('CommunicationBridge'); } validateInputs(inputs) { for (const [key, val] of Object.entries(inputs)) { if (!val || (Array.isArray(val) && val.length === 0)) { console.error(`[CommunicationBridge] Missing input: ${key}`); return false; } } return true; } success(data) { return { success: true, ...data }; } error(msg, err) { console.error(`[CommunicationBridge] ${msg}`, err); return { success: false, message: msg, error: err }; } async sendEmail(recipients, subject, htmlBody) { if (!this.validateInputs({ recipients, subject, htmlBody })) return this.error("Invalid inputs"); try { const { addDoc, collection, db } = window.firebaseServices; await addDoc(collection(db, "mail"), { to: recipients, message: { subject: subject, html: htmlBody }, sentAt: new Date().toISOString(), sourceModule: "CommunicationBridge" }); return this.success({ sent: true, recipientCount: recipients.length }); } catch (error) { return this.error("Failed to send email", error); } } async broadcastToChannel(channel, message) { console.log(`[CommunicationBridge] Broadcasting to #${channel}: ${message}`); return this.success({ broadcast: true, channel }); } }